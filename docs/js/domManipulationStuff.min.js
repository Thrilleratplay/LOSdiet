var selectedApks=localStorage.getItem("LOSdiet_apks")||[],apkListContainer=document.querySelector(".apk-containter"),makeZipButton=document.querySelector('input[type=button][value="Make Zip"]'),filterList=document.querySelector(".filter-list"),apkData;Array.isArray(selectedApks)||(selectedApks=[selectedApks]);var disableMakeZipButton=function(){makeZipButton.disabled=0===selectedApks.length},isApkSelected=function(e){return-1!==selectedApks.indexOf(e.name)},filterApkList=function(e){return isApkSelected(e)||(!e.exportOnly||filterList.querySelector('input[name="expertMode"]:checked'))&&!e.isGoogleApp&&!e.isCM13Only},renderApkList=function(){var e=['<div class="row app-list">','<div class="col s12 m6 l4">','<input type="checkbox" id="<%= apk.name %>" ','<%=(isSelected ? "checked=true": "")%> ',"/>",'<label for="<%= apk.name %>">','<div class="apk-label truncate"><%= apk.label %></div>',"</label>","</div>",'<div class="col hide-on-med-and-down l3">','<div class="truncate">',"<%= apk.packageName %>","</div>",'<div class="truncate">',"<%= apk.name %>.apk</div>","</div>",'<div class="col m6 l5">',"<%= apk.description %>","</div>","</div>"].join("");apkListContainer.innerHTML=apkData.filter(filterApkList).map(function(t){return ejs.render(e,{apk:t,isSelected:isApkSelected(t)})}).join(""),Array.prototype.map.call(apkListContainer.querySelectorAll("input[type=checkbox]"),function(e){e.addEventListener("change",function(){var e=selectedApks.indexOf(this.id);e>-1?selectedApks.splice(e,1):selectedApks.push(this.id),disableMakeZipButton()})}),disableMakeZipButton()},getApkJson=function(){var e=new XMLHttpRequest;e.open("GET","./apkData.json",!0),e.onload=function(){e.status>=200&&e.status<400&&(apkData=JSON.parse(e.responseText),renderApkList())},e.send()};filterList.querySelector('input[name="expertMode"]').onchange=renderApkList,getApkJson();